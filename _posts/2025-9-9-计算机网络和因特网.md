---
layout: post
title: "计算机网络和因特网"
date: 2025-9-9
tags: [编程]
comments: true
author: Minrain
---
## 什么是因特网
回答这个问题有两种方式，第一，我们从因特网的组成，即硬件组成和软件构成方面来回答；第二，我们通过它作为分布式应用的基础设施的功能方面来回答。
### 具体构成描述
无论是手机、电脑，还是新式的汽车、家电、switch等设备，只要接入互联网，都统称为**端系统**。端系统像是建筑物，数据好像货物，要把数据从一个端系统运输到另一个端系统，就像把货物从一个建筑物运送到另一个建筑物：
1. 把大批货物分批装上不同的卡车，并给每个卡车打上记忆标签——把数据分段，给每段加上首部字节，得到的信息包称为**分组**
2. 经高速公路驶向目的地——分组通过**通信链路**运输。常见的通信链路包括同轴电缆、铜线、光纤和无线电频谱，不同链路的**传输速率**不同，单位为bit/s(bps)。
3. 高速公路构成的交通网络上有各类分叉口——**分组交换机**充当分叉口，把不同目的地的数据送上不同的道路。常见的分组交换机有两种，**链路层交换机**和**路由器**。链路层交换机通常用于接入网中，路由器通常用于网络核心中。
4. 货物从出发地运送到目的地，经过的道路称为路径——数据从发出端到接收端，经过的通讯链路和分组交换机称为路径。

端系统通过**ISP**(Internet Service Provider，因特网服务提供商)接入因特网。每个ISP自身就是由多个分组交换机和通讯链路组成的网络。因特网万物互联，因此这些ISP必须互联。较低层的ISP通过国家、国际的较高层ISP互联起来，并且这些较高层的ISP彼此直接互联。无论较高层还是较低层的ISP网络，都是独立管理的，运行着IP协议。

端系统、分组交换机和其它因特网部件都要运行多个协议，管理信息的接收和发送。最重要的是**TCP**(Transmission Control Protocol,传输控制协议)和**IP**(Internet Protocol,因特网协议)两个协议，简称TCP/IP。

**因特网标准**由**IETF**(Internet Engineering Task Force,因特网工程任务组)研发，标准文档称为**RFC**(Request For Commnet,请求评论)。其它组织，如IEEE，也制定了部分网络链路的标准，如以太网和无限WiFi。
### 服务描述
除了因特网物理上的构成，我们还可以从因特网为应用程序提供服务的基础设施角度来描述因特网。**分布式应用**指的是涉及多个相互交换数据的端系统的应用。应用程序运行在端系统上，很容易遇到这样一个问题：你怎么指定应用程序向某个端系统发送讯息呢？

这就引入**套接字接口(socket interface)**的概念，它类似邮政系统中那些规则，你要寄信，需要把信装到信封里，写上邮政编码和目的地，贴上邮票；你要发送数据，就要遵循套接字接口的规矩。
### 什么是协议
想象人类之间的互动，你要向一个陌生人询问时间，你会先说：“你好！”

TA的回应可能有几种：充满热情的你好、“别来烦我”或者干脆不回应。收到对方的答复后，你会根据对方的答复进行不同的操作。比如，对方热情回应，你就会接着问下去，得到时间；对方冷淡或不回应，你一般也就不会继续向下问了。

这个过程中有几个关键点：
1. 你们两个遵循的是同一套协议。也就是说，你们都讲礼貌，清楚时间的概念，不能一个人明白，而另一个人不懂，这样双方就无法交流。
2. 根据对方的反应进行不同的操作。也就是说，不同的事件发生情况会对应不同的结果。

协议也是一样。**协议**定义了两个或多个通信实体之间交换的报文的格式和顺序，以及报文的发送/接收或其他时间采取的操作。

## 网络边缘初探
端系统因位于网络边缘得名。端系统又称**主机(host)**，主机通常又被分为两类：**客户**和**服务器**，通俗的说，平常见到的手机电脑等都属于客户，服务器往往处于**数据中心**，功能更强大，用来存储视频、电子邮件等。服务器的外形像披萨盒，几十个组成一个机架，彼此之间通过复杂的计算机网络互联。
### 接入网
所谓**接入网**，是指将端系统物理连接到其**边缘路由器**的网络。边缘路由器是端系统到任何一个远程端系统所经过的第一台路由器。
#### 家庭接入：DSL、电缆、FTTH和5G固定式无线
DSL即Digital Service Line，FTTH即Fiber to the Home(光纤入户)，这两类加上电缆，都是通过接线，转换电信号和波信号来上网；而5G固定式无线是无线上网。
#### 企业(和家庭)接入：以太网和WiFi
无线局域网技术(Wireless Local Area Network,LAN)解决"最后一公里"问题，用户的漫游设备，如手机等，直接接入无线路由器，无线路由器通过无线模块输送信息给手机，本身大多通过线路接入互联网；以太网，目前可以简单理解成遵循以太协议的局域网。
#### 广义无线接入：3G、LTE 4G和5G
即超大号无线接入，范围不是几十米，而是几万米，通过运营商搭建的基站接入。想想流量的特征。
### 物理媒介
传输比特的媒介主要分两类：**导引型媒介**和**非导引型媒介**，导引型媒介，如割裂线，双绞铜线、同轴电缆、光纤等，材料成本低，但劳动力成本高。
#### 双绞铜线
便宜、常用。高速LAN实现采用的材料。
#### 同轴电缆
接电视常用。
#### 光纤
长途连接使用，如跨海光纤。
#### 陆地无线电信道
电磁频谱。
#### 卫星无线电信道
常用同步卫星和近地轨道卫星。
## 网络核心
端系统的分组交换机和链路构成的系统，通过链路和交换机移动数据一般有两种办法：
分组交换和电路交换。
### 分组交换
#### 存储转发传输
多数交换机使用**存储转发传输**机制，即路由器向外输出一个分组时，必须先接收完这个分组的所有字节。
#### 排队时延和分组丢失
对于相连的每条链路，每个分组交换机存在一个**输出缓存**，存放准备发出的分组。如果分组过多，就会产生排队时延，即必须先发出前面的分组，才能发出后续的分组；如果存储的分组多于输出缓存，就会产生分组丢失，也称丢包。
#### 转发表和路由选择协议
一个路由器接入多条链路，从一条链路上接收分组后，它是如何确定把分组送到哪条链路的？这依赖**转发表**。事实上，每个端系统都有一个**IP地址**，就像邮政系统里的地址一样，路由器使用**路由选择协议**获取转发表，检查分组首部字节中的地址信息，对照转发表将分组发向正确的链路。

想象你开货车把物品从北京运到上海，你又喜欢问路而不使用导航。每到一块区域，你都可以问这里往上海怎么走，尽管也许没人能告诉你详细的路线，但都能告诉你哪条公路是通往上海的。就这样不断的问下去，你就到达了上海。路由器在这里扮演的，就是本地人的角色。
### 电路交换
如果说分组交换是不需要预订的餐厅，电路交换就好比预订制餐厅。分组交换免去了预订的麻烦，走进去就能吃，缺点是人多时不得不忍受排队等候的麻烦；电路交换虽然需要花费时间建立连接，即形成端到端系统之间的**电路**，但理论上就餐时可以即刻用餐，也就是预留了一定的资源，保证通讯的稳定性。
#### 电路交换网络中的复用
链路中的电路通过**频分复用**(Frequency-Division Multiplexing)或时分复用(Time-Division Multiplexing,TDM)实现。所谓频分复用，即规定一个频率区间作为一条链路，这个频率区间的长度就称为**带宽**；所谓时分复用，就是把时间分为帧，又把帧分为多个时隙，每个时隙由某条链接单独使用。总结一下就是，频分复用把带宽分成多份，每条链接使用其中一份；时分复用把时间分成多份，每条链接周期性独享所有带宽。
#### 分组交换与电路交换的对比
现在分组交换几乎取代了电路交换，电路交换退出历史舞台。
#### 网络的网络
局域网一个个接上更大范围的网络，形成今天的互联网。详细内容日后补充。
## 分组交换网中的时延、丢包和吞吐量
### 分组交换网中的时延
分组在沿途的每个节点都经受了几种不同类型的时延，这些时延中比较重要的有**节点处理时延**、**排队时延**、**传播时延**和**传输时延**，这些时延累加起来是**节点总时延**。
#### 时延的类型
1. 处理时延。路由器检查首部字节，决定分组去向的过程花费的时间。微秒或更小级别。
2. 排队时延。网络拥堵时的排队处理时延，毫秒到微秒级别。
3. 传输时延。将分组推向(或发射到)链路所需时间，L/R,毫秒到微秒级别。
4. 传播时延。从一个节点到另一个节点，在链路上花费的时间，d/s，广域网中毫秒级别。

拿汽车和服务区打比方，假设有一个车队行驶在高速公路上，每隔100km有一个服务区，每辆汽车从服务区开出去的时间是恒定的。考虑服务区A到B，那么总A花费的时间，就是在A看导航的时间(处理时延)，排队等待开出去的时间(排队时延)，车队直到最后一辆车开出去的时间(传输时延)，最后一辆车开到B的时间(传播时延)。注意由于存储转发机制，第一辆车到了之后必须等待所有车到达形成车队，才能继续走。这个等待时间，被包含在传输时延中，因为我们考虑的是最后一辆车开出去的时间。
### 排队时延和丢包
a表示每秒到达节点的分组个数，用统一的L表示每个分组的比特数，R表示传输速率。则**流量强度**表示为aL/R，流量强度在设计时必须小于1。
### 端到端时延
即从源端系统到目标端系统所花费的时间。
#### Traceroute
追踪路由器的应用。
#### 端系统、应用程序和其他时延
媒介分组化时延和协议时延。
### 计算机网络中的吞吐量
假设A到B传输一个大文件，**瞬时吞吐量**就是主机B接受文件的速率。关于吞吐量，关键的是**瓶颈链路**的分析，即吞吐量取决于连接中最慢的链路。
## 协议层次及其服务模型
各层的所有协议被称为**协议栈**，因特网的协议栈由5个层次组成：应用层、运输层、网络层、链路层、物理层。
### 分层的体系结构
1. 应用层信息分组称为**报文**。
2. 运输层分组称为**报文段**。
3. 网络层称为**数据报**。
4. 链路层称为**帧**。
### 封装
详细解释一下分层的作用：
1. 应用层报文
2. 运输层添加首部信息，构成报文段
3. 网络层添加首部信息，构成数据报
4. 链路层添加首部信息，构成帧
## 网络安全部分
DoS(Denial-of-Service)，拒绝服务攻击
DDoS(Distributed DoS)，分布式DoS